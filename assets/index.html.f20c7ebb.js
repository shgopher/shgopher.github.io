import{_ as n,c as s}from"./app.e0455488.js";const a={},t=s(`<p align="center"><h1 align="center">Resty \u4E2D\u6587\u6587\u6863</h1><p align="center">Go \u7684\u7B80\u5355\u7684 HTTP \u548C REST \u5BA2\u6237\u7AEF\u5E93 (\u7075\u611F\u6765\u6E90\u4E8E Ruby \u7684 rest-client)</p><p align="center"><a href="#features">Features</a> \u8BE6\u7EC6\u63CF\u8FF0\u4E86 Resty \u7684\u529F\u80FD</p></p><p align="center"><p align="center"><a href="https://travis-ci.org/go-resty/resty"><img src="https://travis-ci.org/go-resty/resty.svg?branch=master" alt="Build Status"></a><a href="https://codecov.io/gh/go-resty/resty/branch/master"><img src="https://codecov.io/gh/go-resty/resty/branch/master/graph/badge.svg" alt="Code Coverage"></a><a href="https://goreportcard.com/report/go-resty/resty"><img src="https://goreportcard.com/badge/go-resty/resty" alt="Go Report Card"></a><a href="https://github.com/go-resty/resty/releases/latest"><img src="https://img.shields.io/badge/version-2.0.0-blue.svg" alt="Release Version"></a><a href="https://godoc.org/github.com/go-resty/resty"><img src="https://godoc.org/github.com/go-resty/resty?status.svg" alt="GoDoc"></a><a href="LICENSE"><img src="https://img.shields.io/github/license/go-resty/resty.svg" alt="License"></a></p></p><p align="center"><h4 align="center">Resty Communication Channels</h4><p align="center"><a href="https://gitter.im/go_resty/community?utm_source=badge&amp;utm_medium=badge&amp;utm_campaign=pr-badge&amp;utm_content=badge"><img src="https://badges.gitter.im/go_resty/community.svg" alt="Chat on Gitter - Resty Community"></a><a href="https://twitter.com/go_resty"><img src="https://img.shields.io/badge/twitter-@go__resty-55acee.svg" alt="Twitter @go_resty"></a></p></p><h2 id="news" tabindex="-1"><a class="header-anchor" href="#news" aria-hidden="true">#</a> News</h2><ul><li>v2.0.0 <a href="https://github.com/go-resty/resty/releases/tag/v2.0.0" target="_blank" rel="noopener noreferrer">released</a> and tagged on Jul 16, 2019.</li><li>v1.12.0 <a href="https://github.com/go-resty/resty/releases/tag/v1.12.0" target="_blank" rel="noopener noreferrer">released</a> and tagged on Feb 27, 2019.</li><li>v1.0 released and tagged on Sep 25, 2017. - Resty&#39;s first version was released on Sep 15, 2015 then it grew gradually as a very handy and helpful library. Its been a two years since first release. I&#39;m very thankful to Resty users and its <a href="https://github.com/go-resty/resty/graphs/contributors" target="_blank" rel="noopener noreferrer">contributors</a>.</li></ul><h2 id="features" tabindex="-1"><a class="header-anchor" href="#features" aria-hidden="true">#</a> Features</h2><ul><li>GET, POST, PUT, DELETE, HEAD, PATCH, OPTIONS, etc.</li><li>Simple and chainable methods for settings and request</li><li>Request Body can be <code>string</code>, <code>[]byte</code>, <code>struct</code>, <code>map</code>, <code>slice</code> and <code>io.Reader</code> too <ul><li>Auto detects <code>Content-Type</code></li><li>Buffer less processing for <code>io.Reader</code></li></ul></li><li><a href="https://godoc.org/github.com/go-resty/resty#Response" target="_blank" rel="noopener noreferrer">Response</a> object gives you more possibility <ul><li>Access as <code>[]byte</code> array - <code>response.Body()</code> OR Access as <code>string</code> - <code>response.String()</code></li><li>Know your <code>response.Time()</code> and when we <code>response.ReceivedAt()</code></li></ul></li><li>Automatic marshal and unmarshal for <code>JSON</code> and <code>XML</code> content type <ul><li>Default is <code>JSON</code>, if you supply <code>struct/map</code> without header <code>Content-Type</code></li><li>For auto-unmarshal, refer to - <ul><li>Success scenario <a href="https://godoc.org/github.com/go-resty/resty#Request.SetResult" target="_blank" rel="noopener noreferrer">Request.SetResult()</a> and <a href="https://godoc.org/github.com/go-resty/resty#Response.Result" target="_blank" rel="noopener noreferrer">Response.Result()</a>.</li><li>Error scenario <a href="https://godoc.org/github.com/go-resty/resty#Request.SetError" target="_blank" rel="noopener noreferrer">Request.SetError()</a> and <a href="https://godoc.org/github.com/go-resty/resty#Response.Error" target="_blank" rel="noopener noreferrer">Response.Error()</a>.</li><li>Supports <a href="https://tools.ietf.org/html/rfc7807" target="_blank" rel="noopener noreferrer">RFC7807</a> - <code>application/problem+json</code> &amp; <code>application/problem+xml</code></li></ul></li></ul></li><li>Easy to upload one or more file(s) via <code>multipart/form-data</code><ul><li>Auto detects file content type</li></ul></li><li>Request URL <a href="https://godoc.org/github.com/go-resty/resty#Request.SetPathParams" target="_blank" rel="noopener noreferrer">Path Params (aka URI Params)</a></li><li>Backoff Retry Mechanism with retry condition function <a href="retry_test.go">reference</a></li><li>Resty client HTTP &amp; REST <a href="https://godoc.org/github.com/go-resty/resty#Client.OnBeforeRequest" target="_blank" rel="noopener noreferrer">Request</a> and <a href="https://godoc.org/github.com/go-resty/resty#Client.OnAfterResponse" target="_blank" rel="noopener noreferrer">Response</a> middlewares</li><li><code>Request.SetContext</code> supported</li><li>Authorization option of <code>BasicAuth</code> and <code>Bearer</code> token</li><li>Set request <code>ContentLength</code> value for all request or particular request</li><li>Custom <a href="https://godoc.org/github.com/go-resty/resty#Client.SetRootCertificate" target="_blank" rel="noopener noreferrer">Root Certificates</a> and Client <a href="https://godoc.org/github.com/go-resty/resty#Client.SetCertificates" target="_blank" rel="noopener noreferrer">Certificates</a></li><li>Download/Save HTTP response directly into File, like <code>curl -o</code> flag. See <a href="https://godoc.org/github.com/go-resty/resty#Client.SetOutputDirectory" target="_blank" rel="noopener noreferrer">SetOutputDirectory</a> &amp; <a href="https://godoc.org/github.com/go-resty/resty#Request.SetOutput" target="_blank" rel="noopener noreferrer">SetOutput</a>.</li><li>Cookies for your request and CookieJar support</li><li>SRV Record based request instead of Host URL</li><li>Client settings like <code>Timeout</code>, <code>RedirectPolicy</code>, <code>Proxy</code>, <code>TLSClientConfig</code>, <code>Transport</code>, etc.</li><li>Optionally allows GET request with payload, see <a href="https://godoc.org/github.com/go-resty/resty#Client.SetAllowGetMethodPayload" target="_blank" rel="noopener noreferrer">SetAllowGetMethodPayload</a></li><li>Supports registering external JSON library into resty, see <a href="https://github.com/go-resty/resty/issues/76#issuecomment-314015250" target="_blank" rel="noopener noreferrer">how to use</a></li><li>Exposes Response reader without reading response (no auto-unmarshaling) if need be, see <a href="https://github.com/go-resty/resty/issues/87#issuecomment-322100604" target="_blank" rel="noopener noreferrer">how to use</a></li><li>Option to specify expected <code>Content-Type</code> when response <code>Content-Type</code> header missing. Refer to <a href="https://github.com/go-resty/resty/issues/92" target="_blank" rel="noopener noreferrer">#92</a></li><li>Resty design <ul><li>Have client level settings &amp; options and also override at Request level if you want to</li><li>Request and Response middlewares</li><li>Create Multiple clients if you want to <code>resty.New()</code></li><li>Supports <code>http.RoundTripper</code> implementation, see <a href="https://godoc.org/github.com/go-resty/resty#Client.SetTransport" target="_blank" rel="noopener noreferrer">SetTransport</a></li><li>goroutine concurrent safe</li><li>Resty Client trace, see <a href="https://godoc.org/github.com/go-resty/resty#Client.EnableTrace" target="_blank" rel="noopener noreferrer">Client.EnableTrace</a> and <a href="https://godoc.org/github.com/go-resty/resty#Request.EnableTrace" target="_blank" rel="noopener noreferrer">Request.EnableTrace</a></li><li>Debug mode - clean and informative logging presentation</li><li>Gzip - Go does it automatically also resty has fallback handling too</li><li>Works fine with <code>HTTP/2</code> and <code>HTTP/1.1</code></li></ul></li><li><a href="#bazel-support">Bazel support</a></li><li>Easily mock Resty for testing, <a href="#mocking-http-requests-using-httpmock-library">for e.g.</a></li><li>Well tested client library</li></ul><h3 id="included-batteries" tabindex="-1"><a class="header-anchor" href="#included-batteries" aria-hidden="true">#</a> Included Batteries</h3><ul><li>\u91CD\u5B9A\u5411\u7B56\u7565 - \u5982\u4F55\u4F7F\u7528\u67E5\u770B <a href="#redirect-policy">\u8FD9\u91CC</a><ul><li>NoRedirectPolicy</li><li>FlexibleRedirectPolicy</li><li>DomainCheckRedirectPolicy</li><li>\u7B49\u7B49\u3002 <a href="redirect.go">\u66F4\u591A\u4FE1\u606F</a></li></ul></li><li>\u91CD\u8BD5\u673A\u5236\uFF0C\u5982\u4F55\u4F7F\u7528\u67E5\u770B <a href="#retries">\u8FD9\u91CC</a><ul><li>Backoff Retry</li><li>Conditional Retry</li></ul></li><li>SRV Record based request instead of Host URL <a href="resty_test.go#L1412">how to use</a></li><li>etc (upcoming - throw your idea&#39;s <a href="https://github.com/go-resty/resty/issues" target="_blank" rel="noopener noreferrer">here</a>).</li></ul><h4 id="supported-go-versions" tabindex="-1"><a class="header-anchor" href="#supported-go-versions" aria-hidden="true">#</a> Supported Go Versions</h4><p>\u6700\u521D\uFF0CResty \u4ECE <code>v1.10.0</code> \u7248\u672C\u5F00\u59CB\u652F\u6301<code>go modules</code>\u3002</p><p>\u4F7F\u7528 Resty v2 \u548C\u66F4\u9AD8\u7684\u7248\u672C, \u5B83\u5B8C\u5168\u5305\u542B <a href="https://github.com/golang/go/wiki/Modules" target="_blank" rel="noopener noreferrer">go modules</a> \u5305\u7248\u672C.\u3002</p><p>\u5B83\u9700\u8981\u4E00\u4E2A\u80FD\u591F\u7406\u89E3 <code>/vN</code> \u540E\u7F00\u5BFC\u5165\u7684 Go \u7248\u672C\uFF1A</p><ul><li>1.9.7+</li><li>1.10.3+</li><li>1.11+</li></ul><h2 id="it-might-be-beneficial-for-your-project" tabindex="-1"><a class="header-anchor" href="#it-might-be-beneficial-for-your-project" aria-hidden="true">#</a> It might be beneficial for your project \u{1F604}</h2><p>Resty \u7684\u4F5C\u8005\u8FD8\u4E3A Go \u53D1\u5E03\u4E86\u4EE5\u4E0B\u9879\u76EE\u3002</p><ul><li><a href="https://aahframework.org" target="_blank" rel="noopener noreferrer">aah framework</a> - \u4E00\u4E2A\u5B89\u5168\u3001\u7075\u6D3B\u3001\u5FEB\u901F\u7684 Go web \u6846\u67B6\u3002</li><li><a href="https://thumbai.app" target="_blank" rel="noopener noreferrer">THUMBAI</a> - Go Mod \u4ED3\u5E93, Go Vanity \u670D\u52A1\u548C\u7B80\u5355\u7684\u4EE3\u7406\u670D\u52A1\u5668\u3002</li><li><a href="https://github.com/jeevatkm/go-model" target="_blank" rel="noopener noreferrer">go-model</a> - \u5065\u58EE\u7684\uFF0C\u6613\u4E8E\u4F7F\u7528\u7684 Go <code>struct</code> \u6A21\u578B\u6620\u5C04\u5668\u548C\u5DE5\u5177\u65B9\u6CD5\u3002</li></ul><h2 id="installation" tabindex="-1"><a class="header-anchor" href="#installation" aria-hidden="true">#</a> Installation</h2><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># Go Modules</span>
require github.com/go-resty/resty/v2 v2.0.0
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="usage" tabindex="-1"><a class="header-anchor" href="#usage" aria-hidden="true">#</a> Usage</h2><p>\u4E0B\u9762\u7684\u793A\u4F8B\u4F1A\u5E2E\u52A9\u4F60\u719F\u6089 resty \u5E93\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u5BFC\u5165 resty</span>
<span class="token keyword">import</span> <span class="token string">&quot;github.com/go-resty/resty/v2&quot;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="simple-get" tabindex="-1"><a class="header-anchor" href="#simple-get" aria-hidden="true">#</a> Simple GET</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
		<span class="token function">EnableTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
		<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;https://httpbin.org/get&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Explore response object</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Response Info:&quot;</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Error      :&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Status Code:&quot;</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span><span class="token function">StatusCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Status     :&quot;</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span><span class="token function">Status</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Time       :&quot;</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span><span class="token function">Time</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Received At:&quot;</span><span class="token punctuation">,</span> resp<span class="token punctuation">.</span><span class="token function">ReceivedAt</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Body       :\\n&quot;</span><span class="token punctuation">,</span> resp<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Explore trace info</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;Request Trace Info:&quot;</span><span class="token punctuation">)</span>
ti <span class="token operator">:=</span> resp<span class="token punctuation">.</span>Request<span class="token punctuation">.</span><span class="token function">TraceInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;DNSLookup    :&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>DNSLookup<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ConnTime     :&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>ConnTime<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;TLSHandshake :&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>TLSHandshake<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ServerTime   :&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>ServerTime<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ResponseTime :&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>ResponseTime<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;TotalTime    :&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>TotalTime<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;IsConnReused :&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>IsConnReused<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;IsConnWasIdle:&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>IsConnWasIdle<span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;ConnIdleTime :&quot;</span><span class="token punctuation">,</span> ti<span class="token punctuation">.</span>ConnIdleTime<span class="token punctuation">)</span>

<span class="token comment">/* Output
Response Info:
Error      : &lt;nil&gt;
Status Code: 200
Status     : 200 OK
Time       : 465.301137ms
Received At: 2019-03-10 01:52:33.772456 -0800 PST m=+0.466672260
Body       :
 {
  &quot;args&quot;: {},
  &quot;headers&quot;: {
    &quot;Accept-Encoding&quot;: &quot;gzip&quot;,
    &quot;Host&quot;: &quot;httpbin.org&quot;,
    &quot;User-Agent&quot;: &quot;go-resty/2.0.0-rc.1 (https://github.com/go-resty/resty)&quot;
  },
  &quot;origin&quot;: &quot;0.0.0.0&quot;,
  &quot;url&quot;: &quot;https://httpbin.org/get&quot;
}

Request Trace Info:
DNSLookup    : 2.21124ms
ConnTime     : 393.875795ms
TLSHandshake : 319.313546ms
ServerTime   : 71.109256ms
ResponseTime : 94.466\xB5s
TotalTime    : 465.301137ms
IsConnReused : false
IsConnWasIdle: false
ConnIdleTime : 0s
*/</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="enhanced-get" tabindex="-1"><a class="header-anchor" href="#enhanced-get" aria-hidden="true">#</a> Enhanced GET</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetQueryParams</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
          <span class="token string">&quot;page_no&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;1&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;limit&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;20&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;sort&quot;</span><span class="token punctuation">:</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;order&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;asc&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;random&quot;</span><span class="token punctuation">:</span>strconv<span class="token punctuation">.</span><span class="token function">FormatInt</span><span class="token punctuation">(</span>time<span class="token punctuation">.</span><span class="token function">Now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Unix</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Accept&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;BC594900518B4F7EAC75BD37F019E08FBC594900518B4F7EAC75BD37F019E08F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/search_result&quot;</span><span class="token punctuation">)</span>


<span class="token comment">// \u4F7F\u7528 Request.SetQueryString \u65B9\u6CD5\u793A\u4F8B</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetQueryString</span><span class="token punctuation">(</span><span class="token string">&quot;productId=232&amp;template=fresh-sample&amp;cat=resty&amp;source=google&amp;kw=buy a lot more&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Accept&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;BC594900518B4F7EAC75BD37F019E08FBC594900518B4F7EAC75BD37F019E08F&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/show_product&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="various-post-method-combinations" tabindex="-1"><a class="header-anchor" href="#various-post-method-combinations" aria-hidden="true">#</a> Various POST method combinations</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// POST JSON string</span>
<span class="token comment">// \u4E0D\u9700\u8981\u8BBE\u7F6E content type, \u5982\u679C\u4F60\u6709 client level \u7684\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token string">\`{&quot;username&quot;:&quot;testuser&quot;, &quot;password&quot;:&quot;testpass&quot;}\`</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetResult</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AuthSuccess<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>    <span class="token comment">// or SetResult(AuthSuccess{}).</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/login&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// POST []byte array</span>
<span class="token comment">// \u4E0D\u9700\u8981\u8BBE\u7F6E content type, \u5982\u679C\u4F60\u6709 client level \u7684\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span><span class="token string">\`{&quot;username&quot;:&quot;testuser&quot;, &quot;password&quot;:&quot;testpass&quot;}\`</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetResult</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AuthSuccess<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>    <span class="token comment">// or SetResult(AuthSuccess{}).</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/login&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// POST Struct, \u9ED8\u8BA4\u4E3A JSON content type\u3002\u4E0D\u9700\u8981\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span>User<span class="token punctuation">{</span>Username<span class="token punctuation">:</span> <span class="token string">&quot;testuser&quot;</span><span class="token punctuation">,</span> Password<span class="token punctuation">:</span> <span class="token string">&quot;testpass&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetResult</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AuthSuccess<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>    <span class="token comment">// or SetResult(AuthSuccess{}).</span>
      <span class="token function">SetError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AuthError<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>       <span class="token comment">// or SetError(AuthError{}).</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/login&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// POST Map, \u9ED8\u8BA4\u4E3A JSON content type\u3002\u4E0D\u9700\u8981\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;testuser&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;testpass&quot;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetResult</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AuthSuccess<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>    <span class="token comment">// or SetResult(AuthSuccess{}).</span>
      <span class="token function">SetError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>AuthError<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>       <span class="token comment">// or SetError(AuthError{}).</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/login&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// POST of raw bytes for file upload. For example: upload file to Dropbox</span>
fileBytes<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/jeeva/mydocument.pdf&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u8FD9\u91CC\u6211\u4EEC\u6CA1\u6709\u8BBE\u7F6E \uFF0C\u56E0\u4E3A go-resty \u4F1A\u81EA\u52A8\u4E3A\u4F60\u68C0\u6D4B content-type</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span>fileBytes<span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetContentLength</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span>          <span class="token comment">// Dropbox expects this value</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;&lt;your-auth-token&gt;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>DropboxError<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>       <span class="token comment">// or SetError(DropboxError{}).</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;https://content.dropboxapi.com/1/files_put/auto/resty/mydocument.pdf&quot;</span><span class="token punctuation">)</span> <span class="token comment">// for upload Dropbox supports PUT too</span>

<span class="token comment">// \u6CE8\u610F: \u5982\u679C content-type \u7684 header, resty \u68C0\u6D4B\u8BF7\u6C42 body/payload \u7684 Content-Type.</span>
<span class="token comment">//   * \u5BF9\u4E8E struct \u548C map \u6570\u636E\u7C7B\u578B\u9ED8\u8BA4\u4E3A &#39;application/json&#39;</span>
<span class="token comment">//   * Fallback is plain text content type</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="sample-put" tabindex="-1"><a class="header-anchor" href="#sample-put" aria-hidden="true">#</a> Sample PUT</h4><p>\u4F60\u53EF\u4EE5\u50CF\u4F7F\u7528 <code>POST</code> \u4E00\u6837\uFF0C\u4F7F\u7528\u5404\u79CD\u7EC4\u5408\u8C03\u7528 <code>PUT</code> \u65B9\u6CD5\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u6CE8\u610F: \u8FD9\u662F PUT \u65B9\u6CD5\u4F7F\u7528\u7684\u4E00\u4E2A\u793A\u4F8B\uFF0C\u66F4\u591A\u7684\u7EC4\u5408\u8BF7\u53C2\u8003 POST</span>

<span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Request goes as JSON content type</span>
<span class="token comment">// \u4E0D\u9700\u8981\u8BBE\u7F6E auth token, error, \u5982\u679C\u4F60\u6709 client level \u7684\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span>Article<span class="token punctuation">{</span>
        Title<span class="token punctuation">:</span> <span class="token string">&quot;go-resty&quot;</span><span class="token punctuation">,</span>
        Content<span class="token punctuation">:</span> <span class="token string">&quot;This is my article content, oh ya!&quot;</span><span class="token punctuation">,</span>
        Author<span class="token punctuation">:</span> <span class="token string">&quot;Jeevanandam M&quot;</span><span class="token punctuation">,</span>
        Tags<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;article&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;sample&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;resty&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;C6A79608-782F-4ED0-A11D-BD82FAD829CD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Error<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>       <span class="token comment">// or SetError(Error{}).</span>
      <span class="token function">Put</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/article/1234&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="sample-patch" tabindex="-1"><a class="header-anchor" href="#sample-patch" aria-hidden="true">#</a> Sample PATCH</h4><p>\u4F60\u53EF\u4EE5\u50CF\u4F7F\u7528 <code>POST</code> \u4E00\u6837\uFF0C\u4F7F\u7528\u5404\u79CD\u7EC4\u5408\u8C03\u7528 <code>PATCH</code> \u65B9\u6CD5\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u6CE8\u610F: \u8FD9\u662F PATCH \u65B9\u6CD5\u4F7F\u7528\u7684\u4E00\u4E2A\u793A\u4F8B\uFF0C\u66F4\u591A\u7684\u7EC4\u5408\u8BF7\u53C2\u8003 POST</span>

<span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Request goes as JSON content type</span>
<span class="token comment">// \u4E0D\u9700\u8981\u8BBE\u7F6E auth token, error, \u5982\u679C\u4F60\u6709 client level \u7684\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span>Article<span class="token punctuation">{</span>
        Tags<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;new tag1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;new tag2&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;C6A79608-782F-4ED0-A11D-BD82FAD829CD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Error<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>       <span class="token comment">// or SetError(Error{}).</span>
      <span class="token function">Patch</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/articles/1234&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="sample-delete-head-options" tabindex="-1"><a class="header-anchor" href="#sample-delete-head-options" aria-hidden="true">#</a> Sample DELETE, HEAD, OPTIONS</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// DELETE a article</span>
<span class="token comment">// \u4E0D\u9700\u8981\u8BBE\u7F6E auth token, error, \u5982\u679C\u4F60\u6709 client level \u7684\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;C6A79608-782F-4ED0-A11D-BD82FAD829CD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Error<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>       <span class="token comment">// or SetError(Error{}).</span>
      <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/articles/1234&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// DELETE a articles with payload/body as a JSON string</span>
<span class="token comment">// \u4E0D\u9700\u8981\u8BBE\u7F6E auth token, error, \u5982\u679C\u4F60\u6709 client level \u7684\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;C6A79608-782F-4ED0-A11D-BD82FAD829CD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Error<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>       <span class="token comment">// or SetError(Error{}).</span>
      <span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetBody</span><span class="token punctuation">(</span><span class="token string">\`{article_ids: [1002, 1006, 1007, 87683, 45432] }\`</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/articles&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// HEAD of resource</span>
<span class="token comment">// \u4E0D\u9700\u8981\u8BBE\u7F6E auth token, error, \u5982\u679C\u4F60\u6709 client level \u7684\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;C6A79608-782F-4ED0-A11D-BD82FAD829CD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Head</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/videos/hi-res-video&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// OPTIONS of resource</span>
<span class="token comment">// \u4E0D\u9700\u8981\u8BBE\u7F6E auth token, error, \u5982\u679C\u4F60\u6709 client level \u7684\u8BBE\u7F6E</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;C6A79608-782F-4ED0-A11D-BD82FAD829CD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Options</span><span class="token punctuation">(</span><span class="token string">&quot;https://myapp.com/servers/nyc-dc-01&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="multipart-file-s-upload" tabindex="-1"><a class="header-anchor" href="#multipart-file-s-upload" aria-hidden="true">#</a> Multipart File(s) upload</h3><h4 id="using-io-reader" tabindex="-1"><a class="header-anchor" href="#using-io-reader" aria-hidden="true">#</a> Using io.Reader</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>profileImgBytes<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/jeeva/test-img.png&quot;</span><span class="token punctuation">)</span>
notesBytes<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> ioutil<span class="token punctuation">.</span><span class="token function">ReadFile</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/jeeva/text-file.txt&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFileReader</span><span class="token punctuation">(</span><span class="token string">&quot;profile_img&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;test-img.png&quot;</span><span class="token punctuation">,</span> bytes<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>profileImgBytes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFileReader</span><span class="token punctuation">(</span><span class="token string">&quot;notes&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;text-file.txt&quot;</span><span class="token punctuation">,</span> bytes<span class="token punctuation">.</span><span class="token function">NewReader</span><span class="token punctuation">(</span>notesBytes<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFormData</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
          <span class="token string">&quot;first_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Jeevanandam&quot;</span><span class="token punctuation">,</span>
          <span class="token string">&quot;last_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;http://myapp.com/upload&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="using-file-directly-from-path" tabindex="-1"><a class="header-anchor" href="#using-file-directly-from-path" aria-hidden="true">#</a> Using File directly from Path</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u4E0A\u4F20\u4E00\u4E2A\u6587\u4EF6</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFile</span><span class="token punctuation">(</span><span class="token string">&quot;profile_img&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/Users/jeeva/test-img.png&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;http://myapp.com/upload&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u4E0A\u4F20\u591A\u4E2A\u6587\u4EF6</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFiles</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;profile_img&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/Users/jeeva/test-img.png&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;notes&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/Users/jeeva/text-file.txt&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;http://myapp.com/upload&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Multipart of form fields and files</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFiles</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;profile_img&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/Users/jeeva/test-img.png&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;notes&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;/Users/jeeva/text-file.txt&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFormData</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;first_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Jeevanandam&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;last_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;zip_code&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;00001&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;city&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;my city&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;access_token&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;C6A79608-782F-4ED0-A11D-BD82FAD829CD&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;http://myapp.com/profile&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="sample-form-submission" tabindex="-1"><a class="header-anchor" href="#sample-form-submission" aria-hidden="true">#</a> Sample Form submission</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u4EE5 POST \u4F5C\u4E3A\u4E00\u4E2A\u7B80\u5355\u7684\u4F8B\u5B50</span>
<span class="token comment">// User Login</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFormData</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;username&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;jeeva&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;mypass&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;http://myapp.com/login&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Followed by profile update</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFormData</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;first_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;Jeevanandam&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;last_name&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;M&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;zip_code&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;00001&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;city&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;new city update&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;http://myapp.com/profile&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Multi value form data</span>
criteria <span class="token operator">:=</span> url<span class="token punctuation">.</span>Values<span class="token punctuation">{</span>
  <span class="token string">&quot;search_criteria&quot;</span><span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span><span class="token string">&quot;book&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;glass&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pencil&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
resp<span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">SetFormDataFromValues</span><span class="token punctuation">(</span>criteria<span class="token punctuation">)</span><span class="token punctuation">.</span>
      <span class="token function">Post</span><span class="token punctuation">(</span><span class="token string">&quot;http://myapp.com/search&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="save-http-response-into-file" tabindex="-1"><a class="header-anchor" href="#save-http-response-into-file" aria-hidden="true">#</a> Save HTTP Response into File</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u8981\u8F93\u51FA\u7684\u76EE\u5F55\u8DEF\u5F84, \u5982\u679C\u76EE\u5F55\u4E0D\u5B58\u5728\uFF0Cgo-resty \u4F1A\u521B\u5EFA</span>
<span class="token comment">// \u8FD9\u662F\u4E00\u4E2A\u53EF\u9009\u9879, \u5982\u679C\u4F60\u8BA1\u5212\u5728 \`Request.SetOutput\` \u4E2D\u4F7F\u7528\u7EDD\u5BF9\u8DEF\u5F84\uFF0C\u53EF\u4EE5\u4E00\u8D77\u4F7F\u7528</span>
client<span class="token punctuation">.</span><span class="token function">SetOutputDirectory</span><span class="token punctuation">(</span><span class="token string">&quot;/Users/jeeva/Downloads&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// HTTP \u54CD\u5E94\u4FDD\u5B58\u5230\u6587\u4EF6\u4E2D, \u7C7B\u4F3C\u4E8E curl \u7684 -o \u6807\u5FD7</span>
<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
          <span class="token function">SetOutput</span><span class="token punctuation">(</span><span class="token string">&quot;plugin/ReplyWithHeader-v5.1-beta.zip&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
          <span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;http://bit.ly/1LouEKr&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u6216\u8005\u4F7F\u7528\u7EDD\u5BF9\u8DEF\u5F84</span>
<span class="token comment">// \u6CE8\u610F: \u8F93\u51FA\u76EE\u5F55\u8DEF\u5F84\u4E0D\u80FD\u7528\u4E8E\u7EDD\u5BF9\u8DEF\u5F84</span>
<span class="token boolean">_</span><span class="token punctuation">,</span> err <span class="token operator">:=</span> client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
          <span class="token function">SetOutput</span><span class="token punctuation">(</span><span class="token string">&quot;/MyDownloads/plugin/ReplyWithHeader-v5.1-beta.zip&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
          <span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;http://bit.ly/1LouEKr&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="request-url-path-params" tabindex="-1"><a class="header-anchor" href="#request-url-path-params" aria-hidden="true">#</a> Request URL Path Params</h4><p>Resty \u63D0\u4F9B\u4E86\u6613\u4E8E\u4F7F\u7528\u7684\u52A8\u6001\u8BF7\u6C42 URL \u8DEF\u5F84\u53C2\u6570\u3002\u53EF\u4EE5\u5728 client \u548C request level \u8BBE\u7F6E\u53C2\u6570\u3002 request level \u8BBE\u7F6E\u7684\u53C2\u6570\u4F1A\u8986\u76D6 client level \u7684\u8BBE\u7F6E\u7684\u76F8\u540C\u53C2\u6570\u7684\u503C\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetPathParams</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
   <span class="token string">&quot;userId&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;sample@sample.com&quot;</span><span class="token punctuation">,</span>
   <span class="token string">&quot;subAccountId&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;100002&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/v1/users/{userId}/{subAccountId}/details&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// Result:</span>
<span class="token comment">//   \u7EC4\u6210\u7684 URL - /v1/users/sample@sample.com/100002/details</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="request-and-response-middleware" tabindex="-1"><a class="header-anchor" href="#request-and-response-middleware" aria-hidden="true">#</a> Request and Response Middleware</h4><p>Resty \u63D0\u4F9B\u4E86\u5904\u7406\u8BF7\u6C42\u548C\u54CD\u5E94\u7684\u4E2D\u95F4\u4EF6\u529F\u80FD\u3002\u5B83\u6BD4\u56DE\u8C03\u51FD\u6570\u66F4\u7075\u6D3B\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u6CE8\u518C Request \u4E2D\u95F4\u4EF6</span>
client<span class="token punctuation">.</span><span class="token function">OnBeforeRequest</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>resty<span class="token punctuation">.</span>Client<span class="token punctuation">,</span> req <span class="token operator">*</span>resty<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token comment">// \u73B0\u5728\u4F60\u53EF\u4EE5\u8BBF\u95EE\u5F53\u524D Client \u548C Request \u5BF9\u8C61</span>
    <span class="token comment">// \u6839\u636E\u4F60\u7684\u9700\u8981\u64CD\u4F5C\u5B83\u4EEC </span>

    <span class="token keyword">return</span> <span class="token boolean">nil</span>  <span class="token comment">// \u6210\u529F\u8FD4\u56DE nil\uFF0C\u5426\u5219\u8FD4\u56DE error</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u6CE8\u518C Response \u4E2D\u95F4\u4EF6</span>
client<span class="token punctuation">.</span><span class="token function">OnAfterResponse</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>c <span class="token operator">*</span>resty<span class="token punctuation">.</span>Client<span class="token punctuation">,</span> resp <span class="token operator">*</span>resty<span class="token punctuation">.</span>Response<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
    <span class="token comment">// Now you have access to Client and current Response object</span>
    <span class="token comment">// manipulate it as per your need</span>

    <span class="token keyword">return</span> <span class="token boolean">nil</span>  <span class="token comment">// if its success otherwise return error</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="redirect-policy" tabindex="-1"><a class="header-anchor" href="#redirect-policy" aria-hidden="true">#</a> Redirect Policy</h4><p>Resty \u63D0\u4F9B\u4E86\u4E00\u4E9B\u53EF\u4EE5\u4F7F\u7528\u91CD\u5B9A\u5411\u7B56\u7565\u7684\u9009\u9879\uFF0C\u800C\u4E14\u5B83\u652F\u6301\u540C\u65F6\u4F7F\u7528\u591A\u4E2A\u7B56\u7565\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E Client \u7684 Redirect Policy. \u6839\u636E\u9700\u8981\u521B\u5EFA\u4E00\u4E2A</span>
client<span class="token punctuation">.</span><span class="token function">SetRedirectPolicy</span><span class="token punctuation">(</span>resty<span class="token punctuation">.</span><span class="token function">FlexibleRedirectPolicy</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">// \u60F3\u8981\u591A\u4E2A\u7B56\u7565\uFF0C\u5982\u91CD\u5B9A\u5411\u8BA1\u6570\uFF0C\u57DF\u540D\u68C0\u67E5\u7B49</span>
client<span class="token punctuation">.</span><span class="token function">SetRedirectPolicy</span><span class="token punctuation">(</span>resty<span class="token punctuation">.</span><span class="token function">FlexibleRedirectPolicy</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                        resty<span class="token punctuation">.</span><span class="token function">DomainCheckRedirectPolicy</span><span class="token punctuation">(</span><span class="token string">&quot;host1.com&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;host2.org&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;host3.net&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h5 id="custom-redirect-policy" tabindex="-1"><a class="header-anchor" href="#custom-redirect-policy" aria-hidden="true">#</a> Custom Redirect Policy</h5><p>\u5B9E\u73B0 <a href="redirect.go#L20">RedirectPolicy</a> \u63A5\u53E3\u5E76\u4E14\u4F7F\u7528 resty client \u6CE8\u518C\u5B83. \u66F4\u591A\u5185\u5BB9\u67E5\u770B <a href="redirect.go">redirect.go</a>\u3002</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u5728 resty.SetRedirectPolicy \u4F7F\u7528\u539F\u59CB\u51FD\u6570</span>
client<span class="token punctuation">.</span><span class="token function">SetRedirectPolicy</span><span class="token punctuation">(</span>resty<span class="token punctuation">.</span><span class="token function">RedirectPolicyFunc</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> via <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u8FD9\u91CC\u5B9E\u73B0\u4F60\u7684\u903B\u8F91</span>

  <span class="token comment">// \u7EE7\u7EED\u91CD\u5B9A\u5411\u8FD4\u56DE nil \uFF0C\u5426\u5219\u8FD4\u56DE error \u4EE5\u505C\u6B62/\u963B\u6B62\u91CD\u5B9A\u5411</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token comment">//---------------------------------------------------</span>

<span class="token comment">// \u4F7F\u7528 struct \u521B\u5EFA\u66F4\u591A\u7684\u7075\u6D3B\u7684 redirect policy</span>
<span class="token keyword">type</span> CustomRedirectPolicy <span class="token keyword">struct</span> <span class="token punctuation">{</span>
  <span class="token comment">// variables goes here</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token punctuation">(</span>c <span class="token operator">*</span>CustomRedirectPolicy<span class="token punctuation">)</span> <span class="token function">Apply</span><span class="token punctuation">(</span>req <span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">,</span> via <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">*</span>http<span class="token punctuation">.</span>Request<span class="token punctuation">)</span> <span class="token builtin">error</span> <span class="token punctuation">{</span>
  <span class="token comment">// \u8FD9\u91CC\u5B9E\u73B0\u4F60\u7684\u903B\u8F91</span>

  <span class="token comment">// \u7EE7\u7EED\u91CD\u5B9A\u5411\u8FD4\u56DE nil \uFF0C\u5426\u5219\u8FD4\u56DE error \u4EE5\u505C\u6B62/\u963B\u6B62\u91CD\u5B9A\u5411</span>
  <span class="token keyword">return</span> <span class="token boolean">nil</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u5728 resty \u91CC\u6CE8\u518C</span>
client<span class="token punctuation">.</span><span class="token function">SetRedirectPolicy</span><span class="token punctuation">(</span>CustomRedirectPolicy<span class="token punctuation">{</span><span class="token comment">/* initialize variables */</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="custom-root-certificates-and-client-certificates" tabindex="-1"><a class="header-anchor" href="#custom-root-certificates-and-client-certificates" aria-hidden="true">#</a> Custom Root Certificates and Client Certificates</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u81EA\u5B9A\u4E49\u7684 Root \u8BC1\u4E66, \u53EA\u9700\u8981\u63D0\u4F9B .pem \u6587\u4EF6</span>
<span class="token comment">// \u4F60\u53EF\u4EE5\u6DFB\u52A0\u4E00\u4E2A\u6216\u591A\u4E2A root \u8BC1\u4E66</span>
client<span class="token punctuation">.</span><span class="token function">SetRootCertificate</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/root/pemFile1.pem&quot;</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span><span class="token function">SetRootCertificate</span><span class="token punctuation">(</span><span class="token string">&quot;/path/to/root/pemFile2.pem&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// ... and so on!</span>

<span class="token comment">// \u6DFB\u52A0 Client \u8BC1\u4E66, \u4F60\u53EF\u4EE5\u6DFB\u52A0\u4E00\u4E2A\u6216\u591A\u4E2A\u8BC1\u4E66</span>
<span class="token comment">// \u521B\u5EFA certificate \u5BF9\u8C61\u7684\u793A\u4F8B</span>
<span class="token comment">// \u4ECE\u4E00\u5BF9\u6587\u4EF6\u4E2D\u89E3\u6790 public/private key. \u8FD9\u4E9B\u6587\u4EF6\u5FC5\u987B\u5305\u542BP EM \u7F16\u7801\u7684\u6570\u636E\u3002</span>
cert1<span class="token punctuation">,</span> err <span class="token operator">:=</span> tls<span class="token punctuation">.</span><span class="token function">LoadX509KeyPair</span><span class="token punctuation">(</span><span class="token string">&quot;certs/client.pem&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;certs/client.key&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
  log<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;ERROR client certificate: %s&quot;</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token comment">// ...</span>

<span class="token comment">// \u6DFB\u52A0\u4E00\u4E2A\u6216\u591A\u4E2A\u8BC1\u4E66</span>
client<span class="token punctuation">.</span><span class="token function">SetCertificates</span><span class="token punctuation">(</span>cert1<span class="token punctuation">,</span> cert2<span class="token punctuation">,</span> cert3<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="proxy-settings-client-as-well-as-at-request-level" tabindex="-1"><a class="header-anchor" href="#proxy-settings-client-as-well-as-at-request-level" aria-hidden="true">#</a> Proxy Settings - Client as well as at Request Level</h4><p>\u9ED8\u8BA4\u60C5\u51B5\u4E0B <code>Go</code> \u652F\u6301\u4ECE\u73AF\u5883\u53D8\u91CF <code>HTTP_PROXY</code> \u83B7\u53D6\u4EE3\u7406\u3002Resty \u63D0\u4F9B\u4E86 <code>SetProxy</code> &amp; <code>RemoveProxy</code>\uFF0C \u6839\u636E\u4F60\u7684\u9700\u8981\u6765\u9009\u62E9\u4EE3\u7406\u3002</p><p><strong>Client Level Proxy</strong> \u5E94\u7528\u4E8E\u6240\u6709\u8BF7\u6C42\u7684\u8BBE\u7F6E</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u4E00\u4E2A Proxy URL \u548C Port</span>
client<span class="token punctuation">.</span><span class="token function">SetProxy</span><span class="token punctuation">(</span><span class="token string">&quot;http://proxyserver:8888&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u79FB\u9664 proxy \u8BBE\u7F6E</span>
client<span class="token punctuation">.</span><span class="token function">RemoveProxy</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="retries" tabindex="-1"><a class="header-anchor" href="#retries" aria-hidden="true">#</a> Retries</h4><p>Resty \u4F7F\u7528 <a href="http://www.awsarchitectureblog.com/2015/03/backoff.html" target="_blank" rel="noopener noreferrer">backoff</a> \u6765\u589E\u52A0\u6BCF\u6B21\u5C1D\u8BD5\u540E\u7684\u91CD\u8BD5\u95F4\u9694\u3002</p><p>\u4F7F\u7528\u793A\u4F8B:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u6BCF\u4E2A client \u914D\u7F6E\u91CD\u8BD5</span>
client<span class="token punctuation">.</span>
    <span class="token comment">// \u5C06\u91CD\u8BD5\u8BA1\u6570\u8BBE\u7F6E\u4E3A \u975E\u96F6 \u4EE5\u542F\u7528\u91CD\u8BD5</span>
    <span class="token function">SetRetryCount</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token comment">// \u4F60\u53EF\u4EE5\u8986\u76D6\u521D\u59CB\u7684\u91CD\u8BD5\u7B49\u5F85\u65F6\u95F4\u3002</span>
    <span class="token comment">// \u9ED8\u8BA4 100 \u6BEB\u79D2.</span>
    <span class="token function">SetRetryWaitTime</span><span class="token punctuation">(</span><span class="token number">5</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token comment">// MaxWaitTime \u4E5F\u53EF\u4EE5\u88AB\u8986\u76D6.</span>
    <span class="token comment">// \u9ED8\u8BA4\u662F 2 \u79D2.</span>
    <span class="token function">SetRetryMaxWaitTime</span><span class="token punctuation">(</span><span class="token number">20</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Second<span class="token punctuation">)</span><span class="token punctuation">.</span>
    <span class="token comment">// SetRetryAfter \u8BBE\u7F6E\u56DE\u8C03\u51FD\u6570\u6765\u8BA1\u7B97\u91CD\u8BD5\u4E4B\u95F4\u7684\u7B49\u5F85\u65F6\u95F4\u3002</span>
    <span class="token comment">// Default (nil) implies exponential backoff with jitter</span>
    <span class="token function">SetRetryAfter</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>client <span class="token operator">*</span>Client<span class="token punctuation">,</span> resp <span class="token operator">*</span>Response<span class="token punctuation">)</span> <span class="token punctuation">(</span>time<span class="token punctuation">.</span>Duration<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">,</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;quota exceeded&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u7684\u8BBE\u7F6E\uFF0C\u5F53\u8BF7\u6C42\u8FD4\u56DE\u975E nil \u7684 error \u65F6\uFF0Cresty \u4F1A\u91CD\u8BD5\u8BF7\u6C42 3 \u6B21\u3002</p><p>\u53EF\u4EE5\u9009\u62E9\u4E3A client \u63D0\u4F9B\u81EA\u5B9A\u4E49\u7684\u91CD\u8BD5\u6761\u4EF6\uFF1A</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

client<span class="token punctuation">.</span><span class="token function">AddRetryCondition</span><span class="token punctuation">(</span>
    <span class="token comment">// RetryConditionFunc type is for retry condition function</span>
	  <span class="token comment">// input: non-nil Response OR request execution error</span>
    <span class="token keyword">func</span><span class="token punctuation">(</span>r <span class="token operator">*</span>resty<span class="token punctuation">.</span>Response<span class="token punctuation">,</span> err <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> r<span class="token punctuation">.</span><span class="token function">StatusCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> http<span class="token punctuation">.</span>StatusTooManyRequests
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4E0A\u9762\u7684\u4F8B\u5B50\uFF0C\u5982\u679C\u8BF7\u6C42\u4EE5 <code>429 Too Many requests</code> \u72B6\u6001\u7801\u7ED3\u675F\uFF0Cresty \u4F1A\u91CD\u8BD5\u8BF7\u6C42\u3002</p><p>\u53EF\u4EE5\u6DFB\u52A0\u591A\u4E2A\u91CD\u8BD5\u6761\u4EF6\u3002</p><p>\u8FD8\u53EF\u4EE5\u4F7F\u7528 <code>resty.Backoff(...)</code> \u83B7\u5F97\u4EFB\u610F\u91CD\u8BD5\u573A\u666F\u7684\u5B9E\u73B0\u3002<a href="retry_test.go">Reference</a>\u3002</p><h4 id="allow-get-request-with-payload" tabindex="-1"><a class="header-anchor" href="#allow-get-request-with-payload" aria-hidden="true">#</a> Allow GET request with Payload</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u5141\u8BB8\u5E26\u6709 Payload \u7684 GET \u8BF7\u6C42\u3002\u9ED8\u8BA4\u662F disabled \u7684\u3002</span>
client<span class="token punctuation">.</span><span class="token function">SetAllowGetMethodPayload</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="wanna-multiple-clients" tabindex="-1"><a class="header-anchor" href="#wanna-multiple-clients" aria-hidden="true">#</a> Wanna Multiple Clients</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// Here you go!</span>
<span class="token comment">// Client 1</span>
client1 <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
client1<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// ...</span>

<span class="token comment">// Client 2</span>
client2 <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
client2<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Head</span><span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org&quot;</span><span class="token punctuation">)</span>
<span class="token comment">// ...</span>

<span class="token comment">// Bend it as per your need!!!</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="remaining-client-settings-its-options" tabindex="-1"><a class="header-anchor" href="#remaining-client-settings-its-options" aria-hidden="true">#</a> Remaining Client Settings &amp; its Options</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// Client level \u7684\u552F\u4E00\u8BBE\u7F6E</span>
<span class="token comment">//--------------------------------</span>
<span class="token comment">// \u542F\u7528 debug \u6A21\u5F0F</span>
client<span class="token punctuation">.</span><span class="token function">SetDebug</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E Client TLSClientConfig</span>
<span class="token comment">// \u8BBE\u7F6E\u81EA\u5B9A\u4E49\u7684 root-certificate. \u53C2\u8003: http://golang.org/pkg/crypto/tls/#example_Dial</span>
client<span class="token punctuation">.</span><span class="token function">SetTLSClientConfig</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tls<span class="token punctuation">.</span>Config<span class="token punctuation">{</span> RootCAs<span class="token punctuation">:</span> roots <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u6216\u8005\u7981\u7528\u5B89\u5168\u68C0\u67E5 (https)</span>
client<span class="token punctuation">.</span><span class="token function">SetTLSClientConfig</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>tls<span class="token punctuation">.</span>Config<span class="token punctuation">{</span> InsecureSkipVerify<span class="token punctuation">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u6839\u636E\u9700\u8981\u8BBE\u7F6E client \u8D85\u65F6</span>
client<span class="token punctuation">.</span><span class="token function">SetTimeout</span><span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">*</span> time<span class="token punctuation">.</span>Minute<span class="token punctuation">)</span>


<span class="token comment">// \u5982\u679C\u4F60\u60F3\uFF0C\u4F60\u53EF\u4EE5\u5728 request level \u8986\u76D6\u4E0B\u9762\u7684\u6240\u6709\u7684\u8BBE\u7F6E\u548C\u9009\u9879</span>
<span class="token comment">//--------------------------------------------------------------------------------</span>
<span class="token comment">// \u8BBE\u7F6E\u6240\u6709\u8BF7\u6C42\u7684 Host URL\u3002\u5C31\u53EF\u4EE5\u5728\u6240\u6709\u8BF7\u6C42\u4E2D\u4F7F\u7528\u76F8\u5BF9\u8DEF\u5F84</span>
client<span class="token punctuation">.</span><span class="token function">SetHostURL</span><span class="token punctuation">(</span><span class="token string">&quot;http://httpbin.org&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u6240\u6709\u8BF7\u6C42\u7684 Headers</span>
client<span class="token punctuation">.</span><span class="token function">SetHeader</span><span class="token punctuation">(</span><span class="token string">&quot;Accept&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span><span class="token function">SetHeaders</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
        <span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;application/json&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;User-Agent&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;My custom User Agent String&quot;</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u6240\u6709\u8BF7\u6C42\u7684 Cookies</span>
client<span class="token punctuation">.</span><span class="token function">SetCookie</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>http<span class="token punctuation">.</span>Cookie<span class="token punctuation">{</span>
      Name<span class="token punctuation">:</span><span class="token string">&quot;go-resty&quot;</span><span class="token punctuation">,</span>
      Value<span class="token punctuation">:</span><span class="token string">&quot;This is cookie value&quot;</span><span class="token punctuation">,</span>
      Path<span class="token punctuation">:</span> <span class="token string">&quot;/&quot;</span><span class="token punctuation">,</span>
      Domain<span class="token punctuation">:</span> <span class="token string">&quot;sample.com&quot;</span><span class="token punctuation">,</span>
      MaxAge<span class="token punctuation">:</span> <span class="token number">36000</span><span class="token punctuation">,</span>
      HttpOnly<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      Secure<span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span><span class="token function">SetCookies</span><span class="token punctuation">(</span>cookies<span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u6240\u6709\u8BF7\u6C42\u7684 URL query parameters</span>
client<span class="token punctuation">.</span><span class="token function">SetQueryParam</span><span class="token punctuation">(</span><span class="token string">&quot;user_id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;00001&quot;</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span><span class="token function">SetQueryParams</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span> <span class="token comment">// sample of those who use this manner</span>
      <span class="token string">&quot;api_key&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;api-key-here&quot;</span><span class="token punctuation">,</span>
      <span class="token string">&quot;api_secert&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;api-secert&quot;</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetQueryString</span><span class="token punctuation">(</span><span class="token string">&quot;productId=232&amp;template=fresh-sample&amp;cat=resty&amp;source=google&amp;kw=buy a lot more&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u6240\u6709\u8BF7\u6C42\u7684 Form data. \u901A\u5E38\u548C POST and PUT \u4E00\u8D77</span>
client<span class="token punctuation">.</span><span class="token function">SetFormData</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>
    <span class="token string">&quot;access_token&quot;</span><span class="token punctuation">:</span> <span class="token string">&quot;BC594900-518B-4F7E-AC75-BD37F019E08F&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u6240\u6709\u8BF7\u6C42\u7684 Basic Auth</span>
client<span class="token punctuation">.</span><span class="token function">SetBasicAuth</span><span class="token punctuation">(</span><span class="token string">&quot;myuser&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;mypass&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u6240\u6709\u8BF7\u6C42\u7684 Bearer Auth Token</span>
client<span class="token punctuation">.</span><span class="token function">SetAuthToken</span><span class="token punctuation">(</span><span class="token string">&quot;BC594900518B4F7EAC75BD37F019E08FBC594900518B4F7EAC75BD37F019E08F&quot;</span><span class="token punctuation">)</span>

<span class="token comment">// \u542F\u7528\u6240\u6709\u8BF7\u6C42\u7684 Content length value</span>
client<span class="token punctuation">.</span><span class="token function">SetContentLength</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span>

<span class="token comment">// \u4E3A JSON/XML \u8BF7\u6C42\u6CE8\u518C\u5168\u5C40\u7684 Error \u5BF9\u8C61\u7ED3\u6784\u4F53</span>
client<span class="token punctuation">.</span><span class="token function">SetError</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>Error<span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span>    <span class="token comment">// or resty.SetError(Error{})</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="unix-socket" tabindex="-1"><a class="header-anchor" href="#unix-socket" aria-hidden="true">#</a> Unix Socket</h4><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code>unixSocket <span class="token operator">:=</span> <span class="token string">&quot;/var/run/my_socket.sock&quot;</span>

<span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Go \u539F\u751F\u7684 http.Transport \uFF0C\u8FD9\u6837\u53EF\u4EE5\u5728 resty \u4E2D\u8BBE\u7F6E\u5B83.</span>
transport <span class="token operator">:=</span> http<span class="token punctuation">.</span>Transport<span class="token punctuation">{</span>
	Dial<span class="token punctuation">:</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token boolean">_</span><span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>net<span class="token punctuation">.</span>Conn<span class="token punctuation">,</span> <span class="token builtin">error</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span> net<span class="token punctuation">.</span><span class="token function">Dial</span><span class="token punctuation">(</span><span class="token string">&quot;unix&quot;</span><span class="token punctuation">,</span> unixSocket<span class="token punctuation">)</span>
	<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u8BBE\u7F6E\u4E4B\u524D\u521B\u5EFA\u7684 transport, \u5C06\u901A\u4FE1 scheme \u8BBE\u7F6E\u4E3A\u5957\u63A5\u5B57\uFF0C\u5E76\u5C06 unixSocket \u8BBE\u7F6E\u4E3A HostURL\u3002</span>
client<span class="token punctuation">.</span><span class="token function">SetTransport</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>transport<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetScheme</span><span class="token punctuation">(</span><span class="token string">&quot;http&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">SetHostURL</span><span class="token punctuation">(</span>unixSocket<span class="token punctuation">)</span>

<span class="token comment">// \u4E0D\u9700\u8981\u5728\u8BF7\u6C42\u4E0A\u5199\u4E3B\u673A\u7684 URL\uFF0C\u53EA\u9700\u8981\u8DEF\u5F84\u3002</span>
client<span class="token punctuation">.</span><span class="token function">R</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&quot;/index.html&quot;</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="bazel-support" tabindex="-1"><a class="header-anchor" href="#bazel-support" aria-hidden="true">#</a> Bazel support</h4><p>Resty \u53EF\u4EE5\u901A\u8FC7 <a href="https://bazel.build" target="_blank" rel="noopener noreferrer">Bazel</a> \u6784\u5EFA\u3001\u6D4B\u8BD5\u548C\u4F9D\u8D56 . \u4F8B\u5982\uFF0C\u8FD0\u884C\u6240\u6709 test:</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code>bazel <span class="token builtin class-name">test</span> :go_default_test
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h4 id="mocking-http-requests-using-httpmock-library" tabindex="-1"><a class="header-anchor" href="#mocking-http-requests-using-httpmock-library" aria-hidden="true">#</a> Mocking http requests using <a href="https://github.com/jarcoal/httpmock" target="_blank" rel="noopener noreferrer">httpmock</a> library</h4><p>\u4E3A\u4E86\u5728\u6D4B\u8BD5\u5E94\u7528\u7A0B\u5E8F\u65F6\u6A21\u62DF http \u8BF7\u6C42\uFF0C\u53EF\u4EE5\u4F7F\u7528 <code>httpmock</code> \u5E93\u3002 \u5F53\u4F7F\u7528\u9ED8\u8BA4 resty client, \u8981\u628A client \u4F20\u9012\u7ED9\u5E93\uFF0C\u50CF\u4E0B\u9762\u8FD9\u6837:</p><div class="language-go ext-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// \u521B\u5EFA\u4E00\u4E2A Resty Client</span>
client <span class="token operator">:=</span> resty<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// \u83B7\u53D6\u5E95\u5C42\u7684 HTTP Client\uFF0C\u5E76\u8BBE\u7F6E\u4E3A Mock</span>
httpmock<span class="token punctuation">.</span><span class="token function">ActivateNonDefault</span><span class="token punctuation">(</span>client<span class="token punctuation">.</span><span class="token function">GetClient</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>\u4F7F\u7528 ginko \u6A21\u62DF resty http \u8BF7\u6C42\u7684\u66F4\u8BE6\u7EC6\u793A\u4F8B\u5728 <a href="https://github.com/jarcoal/httpmock#ginkgo--resty-example" target="_blank" rel="noopener noreferrer">\u8FD9\u91CC</a>\u3002</p><h2 id="versioning" tabindex="-1"><a class="header-anchor" href="#versioning" aria-hidden="true">#</a> Versioning</h2><p>Resty releases versions according to <a href="http://semver.org" target="_blank" rel="noopener noreferrer">Semantic Versioning</a></p><ul><li>Resty v2 does not use <code>gopkg.in</code> service for library versioning.</li><li>Resty fully adapted to <code>go mod</code> capabilities since <code>v1.10.0</code> release.</li><li>Resty v1 series was using <code>gopkg.in</code> to provide versioning. <code>gopkg.in/resty.vX</code> points to appropriate tagged versions; <code>X</code> denotes version series number and it&#39;s a stable release for production use. For e.g. <code>gopkg.in/resty.v0</code>.</li><li>Development takes place at the master branch. Although the code in master should always compile and test successfully, it might break API&#39;s. I aim to maintain backwards compatibility, but sometimes API&#39;s and behavior might be changed to fix a bug.</li></ul><h2 id="contribution" tabindex="-1"><a class="header-anchor" href="#contribution" aria-hidden="true">#</a> Contribution</h2><p>I would welcome your contribution! If you find any improvement or issue you want to fix, feel free to send a pull request, I like pull requests that include test cases for fix/enhancement. I have done my best to bring pretty good code coverage. Feel free to write tests.</p><p>BTW, I&#39;d like to know what you think about <code>Resty</code>. Kindly open an issue or send me an email; it&#39;d mean a lot to me.</p><h2 id="creator" tabindex="-1"><a class="header-anchor" href="#creator" aria-hidden="true">#</a> Creator</h2><p><a href="https://github.com/jeevatkm" target="_blank" rel="noopener noreferrer">Jeevanandam M.</a> (jeeva@myjeeva.com)</p><h2 id="contributors" tabindex="-1"><a class="header-anchor" href="#contributors" aria-hidden="true">#</a> Contributors</h2><p>Have a look on <a href="https://github.com/go-resty/resty/graphs/contributors" target="_blank" rel="noopener noreferrer">Contributors</a> page.</p><h2 id="license" tabindex="-1"><a class="header-anchor" href="#license" aria-hidden="true">#</a> License</h2><p>Resty released under MIT license, refer <a href="LICENSE">LICENSE</a> file.</p>`,100);function e(p,o){return t}var i=n(a,[["render",e],["__file","index.html.vue"]]);export{i as default};
